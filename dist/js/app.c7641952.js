(function(){"use strict";var e={976:function(e,t,i){var a=i(3751),n=i(641);const o={id:"app"};function s(e,t,i,a,s,r){const l=(0,n.g2)("AudioVisualiser");return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.bF)(l)])}var r=i(33),l=i.p+"img/anime.34ed0f6f.png";const c={class:"visualiser-wrapper"},d={id:"title"},h=(0,n.Lk)("img",{id:"anime",src:l},null,-1),u=["hidden"],p=(0,n.Lk)("div",{id:"out"},null,-1);function m(e,t,i,a,o,s){const l=(0,n.g2)("Toast"),m=(0,n.g2)("ThreeVisualiser"),f=(0,n.g2)("SpeedDial");return(0,n.uX)(),(0,n.CE)("div",c,[(0,n.Lk)("input",{onChange:t[0]||(t[0]=(...e)=>s.handleFileUpload&&s.handleFileUpload(...e)),type:"file",accept:"audio/*",ref:"fileInput",hidden:""},null,544),(0,n.Lk)("h1",d,(0,r.v_)(o.title),1),h,(0,n.Lk)("audio",{id:"audio",controls:"",hidden:!o.showAudio},null,8,u),p,(0,n.bF)(l,{style:{opacity:"0.7"}}),(0,n.bF)(m,{audioProp:o.audioElem,audioStream:o.stream},null,8,["audioProp","audioStream"]),(0,n.bF)(f,{tooltipOptions:{position:"left"},model:s.items,transitionDelay:80,showIcon:s.speedDialIcon,style:(0,r.Tr)("position: fixed; bottom: "+s.speedDialOffset+"px; right: 10px; z-index: 15; text-decoration: none;"),disabled:o.isStreaming,hideIcon:"pi pi-times",buttonClass:"p-button-info",direction:"up",mask:""},null,8,["model","showIcon","style","disabled"])])}i(4603),i(7566),i(8721);const f={ref:"canvasContainer",class:"visualiser-container"};function g(e,t,i,a,o,s){return(0,n.uX)(),(0,n.CE)("div",f,null,512)}i(4114),i(6573),i(8100),i(7936),i(7467),i(4732),i(9577);var v=i(9437),w={data(){return{animationFrameId:0,bars:[]}},props:{audioProp:Object,audioStream:Object},watch:{audioProp(e){e&&this.play(0)},audioStream(e){e&&this.play(1)}},methods:{initThreeJS(){this.scene=new v.Z58,this.group=new v.YJl;const e=this.$refs.canvasContainer.clientWidth/this.$refs.canvasContainer.clientHeight,t=100;this.camera=new v.qUd(t*e/-2,t*e/2,t/2,t/-2,.1,1e3),this.camera.position.set(0,0,100),this.camera.lookAt(this.scene.position),this.scene.add(this.camera),this.renderer=new v.JeP({alpha:!0,antialias:!0});const i=this.$refs.canvasContainer.clientWidth,a=this.$refs.canvasContainer.clientHeight;this.renderer.setSize(i,a),this.renderer.setPixelRatio(window.devicePixelRatio),this.$refs.canvasContainer.appendChild(this.renderer.domElement);const n=new v.$p8(16777215,1);this.scene.add(n),window.addEventListener("resize",this.onWindowResize)},createHalo(){const e=new v.rKP(10,12,1e3),t=new v.V9B({color:4056575,side:v.$EB});this.plane=new v.eaF(e,t),this.plane.rotation.x=Math.PI/4,this.plane.position.x-=1.5,this.group.add(this.plane),this.scene.add(this.group)},createBars(e){const t=2,i=.3,a=-e*(t+i)/2,n=new v.V9B({color:16777215,opacity:.3,transparent:!0}),o=this.$refs.canvasContainer.offsetHeight,s=.5*o-50;for(let r=0;r<e;r++){const e=new v.iNn(t,1,1),l=new v.eaF(e,n);l.position.x=a+r*(t+i),l.position.y=-o/2+s,this.bars.push(l),this.scene.add(l)}},play(e){switch(this.context.resume(),e){case 0:this.elemSrc=this.context.createMediaElementSource(this.audioProp),this.elemSrc.connect(this.analyser),this.analyser.connect(this.context.destination);break;case 1:this.streamSrc=this.context.createMediaStreamSource(this.audioStream),this.streamSrc.connect(this.analyser);break;default:break}this.analyser.fftSize=512;const t=this.analyser.frequencyBinCount;this.dataArray=new Uint8Array(t),this.initThreeJS(),this.createHalo(),this.createBars(t),this.animate()},animate(){this.animationFrameId=requestAnimationFrame(this.animate),this.analyser.getByteFrequencyData(this.dataArray);const e=this.bars.length,t=.5,i=.1;for(let c=0;c<e;c++){const e=this.dataArray[c]/256*150;Math.abs(e-this.bars[c].scale.y)>t&&(this.bars[c].scale.y+=(e-this.bars[c].scale.y)*i)}let a=0;for(let c=0;c<this.dataArray.length;c++)a+=this.dataArray[c];a/=this.dataArray.length;const n=a/256*5+4.7;this.plane.position.y=n;const o=a/256*1.5,s=new v.Q1f(4056575),r=new v.Q1f(16777215),l=s.lerp(r,o);this.plane.material.color.set(l),this.renderer.render(this.scene,this.camera)},onWindowResize(){const e=this.$refs.canvasContainer.clientWidth,t=this.$refs.canvasContainer.clientHeight,i=e/t,a=100;this.camera.left=a*i/-2,this.camera.right=a*i/2,this.camera.top=a/2,this.camera.bottom=a/-2,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t),this.renderer.setPixelRatio(window.devicePixelRatio)}},beforeUnmount(){window.removeEventListener("resize",this.onWindowResize),this.context&&this.context.close(),cancelAnimationFrame(this.animationFrameId)},created(){this.context=new AudioContext,this.analyser=this.context.createAnalyser()}},b=i(6262);const y=(0,b.A)(w,[["render",g],["__scopeId","data-v-d51e21f4"]]);var k=y,A={name:"AudioVisualiser",components:{ThreeVisualiser:k},data(){return{title:"Audio Visualiser",audioElem:null,stream:null,isLooping:!1,isStreaming:!1,auraInterval:null,showAudio:!1}},computed:{items(){let e={label:"Upload MP3",icon:"pi pi-upload",command:()=>this.triggerFileUpload()},t={label:"Loop Audio",icon:"pi pi-sync",command:()=>this.triggerLoop(),disabled:!this.showAudio},i={label:"Stream",icon:"pi pi-desktop",command:()=>this.triggerStream()},a=[e];return a=this.isMobile()||this.showAudio?[...a,t]:[...a,t,i],a},speedDialIcon(){return this.isStreaming?"pi pi-sync pi-desktop":this.isLooping?"pi pi-sync pi-spin":"pi pi-star-fill"},speedDialOffset(){return this.showAudio?90:20}},methods:{triggerFileUpload(){this.$refs.fileInput.click()},handleFileUpload(e){this.audioElem=document.getElementById("audio");const t=e.target.files[0];t&&(this.title=t.name.substring(0,31),this.title!==t.name&&(this.title+="..."),this.audioElem.src=URL.createObjectURL(t),this.audioElem.load(),this.audioElem.muted=!1,this.showAudio=!0,this.audioElem.play(),this.audioElem.addEventListener("play",this.startAuraAnimation),this.audioElem.addEventListener("pause",this.stopAuraAnimation))},triggerStream(){navigator.mediaDevices.getDisplayMedia({video:{displaySurface:"browser"},audio:!0}).then((e=>{const t=e.getAudioTracks();t.length>0?(this.startAuraAnimation(),this.stream=e,this.isStreaming=!0):this.$toast.add({severity:"info",summary:"No Audio Detected",detail:"Did you enable audio sharing?",life:3e3})})).catch((e=>{console.log(e)}))},triggerLoop(){this.audioElem&&(document.getElementById("audio").loop=!document.getElementById("audio").loop,this.isLooping=!this.isLooping)},startAuraAnimation(){this.auraInterval&&clearInterval(this.auraInterval),this.auraInterval=setInterval(this.animateAura,10)},stopAuraAnimation(){clearInterval(this.auraInterval),document.getElementById("anime").style.filter="none"},animateAura(){const e=10*(Math.random()-.5),t=10*(Math.random()-.5),i=5+Math.random(),a=`#${Math.floor(16777215*Math.random()).toString(16)}`;document.getElementById("anime").style.filter=`drop-shadow(${e}px ${t}px ${i}px ${a})`},isMobile(){let e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}}};const x=(0,b.A)(A,[["render",m]]);var S=x,E={name:"App",components:{AudioVisualiser:S}};const I=(0,b.A)(E,[["render",s]]);var z=I,C=i(3255),F=i(431),L=i(7798),O=i(3185);const $=(0,a.Ef)(z);$.use(C.Ay),$.use(F.A),$.component("SpeedDial",L.A),$.component("Toast",O.A),$.mount("#app")}},t={};function i(a){var n=t[a];if(void 0!==n)return n.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,i),o.exports}i.m=e,function(){var e=[];i.O=function(t,a,n,o){if(!a){var s=1/0;for(d=0;d<e.length;d++){a=e[d][0],n=e[d][1],o=e[d][2];for(var r=!0,l=0;l<a.length;l++)(!1&o||s>=o)&&Object.keys(i.O).every((function(e){return i.O[e](a[l])}))?a.splice(l--,1):(r=!1,o<s&&(s=o));if(r){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[a,n,o]}}(),function(){i.d=function(e,t){for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.p="/audio-visualiser/"}(),function(){var e={524:0};i.O.j=function(t){return 0===e[t]};var t=function(t,a){var n,o,s=a[0],r=a[1],l=a[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(l)var d=l(i)}for(t&&t(a);c<s.length;c++)o=s[c],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(d)},a=self["webpackChunkaudio_visualiser"]=self["webpackChunkaudio_visualiser"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=i.O(void 0,[504],(function(){return i(976)}));a=i.O(a)})();
//# sourceMappingURL=app.c7641952.js.map