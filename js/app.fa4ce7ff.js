(function(){"use strict";var t={5541:function(t,e,i){var n=i(3751),a=i(641);const o={id:"app"};function s(t,e,i,n,s,r){const l=(0,a.g2)("AudioVisualiser");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(l)])}var r=i(33),l=i.p+"img/anime.34ed0f6f.png";const c={class:"visualiser-wrapper"},h={id:"title"},d=(0,a.Lk)("img",{id:"anime",src:l},null,-1),u=(0,a.Lk)("audio",{id:"audio",controls:""},null,-1),p=(0,a.Lk)("div",{id:"out"},null,-1);function m(t,e,i,n,o,s){const l=(0,a.g2)("ThreeVisualiser"),m=(0,a.g2)("SpeedDial");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("input",{onChange:e[0]||(e[0]=(...t)=>s.handleFileUpload&&s.handleFileUpload(...t)),type:"file",accept:"audio/*",ref:"fileInput",hidden:""},null,544),(0,a.Lk)("h1",h,(0,r.v_)(o.title),1),d,u,p,(0,a.bF)(l,{audioProp:o.audio},null,8,["audioProp"]),(0,a.bF)(m,{tooltipOptions:{position:"left"},model:o.items,transitionDelay:80,showIcon:s.speedDialIcon,style:"position: fixed; bottom: 90px; right: 10px; z-index: 15; text-decoration: none;",hideIcon:"pi pi-times",buttonClass:"p-button-info",direction:"up",mask:""},null,8,["model","showIcon"])])}i(4603),i(7566),i(8721);const f={ref:"canvasContainer",class:"visualiser-container"};function v(t,e,i,n,o,s){return(0,a.uX)(),(0,a.CE)("div",f,null,512)}i(4114),i(6573),i(8100),i(7936),i(7467),i(4732),i(9577);var g=i(9437),y={data(){return{animationFrameId:0,bars:[]}},props:{audioProp:Object},watch:{audioProp(){this.play()}},methods:{initThreeJS(){this.scene=new g.Z58,this.group=new g.YJl;const t=this.$refs.canvasContainer.clientWidth/this.$refs.canvasContainer.clientHeight,e=100;this.camera=new g.qUd(e*t/-2,e*t/2,e/2,e/-2,.1,1e3),this.camera.position.set(0,0,100),this.camera.lookAt(this.scene.position),this.scene.add(this.camera),this.renderer=new g.JeP({alpha:!0,antialias:!0});const i=this.$refs.canvasContainer.clientWidth,n=this.$refs.canvasContainer.clientHeight;this.renderer.setSize(i,n),this.renderer.setPixelRatio(window.devicePixelRatio),this.$refs.canvasContainer.appendChild(this.renderer.domElement);const a=new g.$p8(16777215,1);this.scene.add(a),window.addEventListener("resize",this.onWindowResize)},createHalo(){const t=new g.rKP(10,12,1e3),e=new g.V9B({color:4056575,side:g.$EB});this.plane=new g.eaF(t,e),this.plane.rotation.x=Math.PI/4,this.plane.position.x-=1.5,this.group.add(this.plane),this.scene.add(this.group)},createBars(t){const e=2,i=.3,n=-t*(e+i)/2,a=new g.V9B({color:16777215,opacity:.3,transparent:!0}),o=this.$refs.canvasContainer.offsetHeight,s=.5*o-50;for(let r=0;r<t;r++){const t=new g.iNn(e,1,1),l=new g.eaF(t,a);l.position.x=n+r*(e+i),l.position.y=-o/2+s,this.bars.push(l),this.scene.add(l)}},play(){this.context.resume(),this.src=this.context.createMediaElementSource(this.audioProp),this.src.connect(this.analyser),this.analyser.connect(this.context.destination),this.analyser.fftSize=512;const t=this.analyser.frequencyBinCount;this.dataArray=new Uint8Array(t),this.initThreeJS(),this.createHalo(),this.createBars(t),this.animate()},animate(){this.animationFrameId=requestAnimationFrame(this.animate),this.analyser.getByteFrequencyData(this.dataArray);const t=this.bars.length,e=Math.floor(this.dataArray.length/t),i=.1;for(let c=0;c<t;c++){let t=0;for(let i=0;i<e;i++)t+=this.dataArray[c*e+i];const n=t/e,a=n/256*150;Math.abs(a-this.bars[c].scale.y)>i&&(this.bars[c].scale.y+=.1*(a-this.bars[c].scale.y))}let n=0;for(let c=0;c<this.dataArray.length;c++)n+=this.dataArray[c];n/=this.dataArray.length;const a=n/256*5+4.7;this.plane.position.y=a;const o=n/256*1.5,s=new g.Q1f(4056575),r=new g.Q1f(16777215),l=s.lerp(r,o);this.plane.material.color.set(l),this.renderer.render(this.scene,this.camera)},onWindowResize(){const t=this.$refs.canvasContainer.clientWidth,e=this.$refs.canvasContainer.clientHeight,i=t/e,n=100;this.camera.left=n*i/-2,this.camera.right=n*i/2,this.camera.top=n/2,this.camera.bottom=n/-2,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.renderer.setPixelRatio(window.devicePixelRatio)}},beforeUnmount(){window.removeEventListener("resize",this.onWindowResize),this.context&&this.context.close(),cancelAnimationFrame(this.animationFrameId)},created(){this.context=new AudioContext,this.analyser=this.context.createAnalyser()}},w=i(6262);const A=(0,w.A)(y,[["render",v],["__scopeId","data-v-0e88ef42"]]);var b=A,x={name:"AudioVisualiser",components:{ThreeVisualiser:b},data(){return{title:"Audio Visualiser",items:[{label:"Upload MP3",icon:"pi pi-upload",command:()=>this.triggerFileUpload()},{label:"Loop",icon:"pi pi-sync",command:()=>this.triggerLoop()}],audio:null,isLooping:!1,auraInterval:null}},computed:{speedDialIcon(){return this.isLooping?"pi pi-sync pi-spin":"pi pi-star-fill"}},methods:{triggerFileUpload(){this.$refs.fileInput.click()},handleFileUpload(t){this.audio=document.getElementById("audio");const e=t.target.files[0];e&&(this.title=e.name.substring(0,31),this.title!==e.name&&(this.title+="..."),this.audio.src=URL.createObjectURL(e),this.audio.load(),this.audio.play(),this.audio.addEventListener("play",this.startAuraAnimation),this.audio.addEventListener("pause",this.stopAuraAnimation))},triggerLoop(){document.getElementById("audio").loop=!document.getElementById("audio").loop,this.isLooping=!this.isLooping},startAuraAnimation(){this.auraInterval=setInterval(this.animateAura,10)},stopAuraAnimation(){clearInterval(this.auraInterval),document.getElementById("anime").style.filter="none"},animateAura(){const t=10*(Math.random()-.5),e=10*(Math.random()-.5),i=5+Math.random(),n=`#${Math.floor(16777215*Math.random()).toString(16)}`;document.getElementById("anime").style.filter=`drop-shadow(${t}px ${e}px ${i}px ${n})`}}};const I=(0,w.A)(x,[["render",m]]);var C=I,L={name:"App",components:{AudioVisualiser:C}};const E=(0,w.A)(L,[["render",s]]);var F=E,P=i(3255),$=i(3101),O=i(3313);const k=(0,n.Ef)(F);k.use(P.Ay),k.component("Button",$.A),k.component("SpeedDial",O.A),k.mount("#app")}},e={};function i(n){var a=e[n];if(void 0!==a)return a.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,i),o.exports}i.m=t,function(){var t=[];i.O=function(e,n,a,o){if(!n){var s=1/0;for(h=0;h<t.length;h++){n=t[h][0],a=t[h][1],o=t[h][2];for(var r=!0,l=0;l<n.length;l++)(!1&o||s>=o)&&Object.keys(i.O).every((function(t){return i.O[t](n[l])}))?n.splice(l--,1):(r=!1,o<s&&(s=o));if(r){t.splice(h--,1);var c=a();void 0!==c&&(e=c)}}return e}o=o||0;for(var h=t.length;h>0&&t[h-1][2]>o;h--)t[h]=t[h-1];t[h]=[n,a,o]}}(),function(){i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.p="/audio-visualiser/"}(),function(){var t={524:0};i.O.j=function(e){return 0===t[e]};var e=function(e,n){var a,o,s=n[0],r=n[1],l=n[2],c=0;if(s.some((function(e){return 0!==t[e]}))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(l)var h=l(i)}for(e&&e(n);c<s.length;c++)o=s[c],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return i.O(h)},n=self["webpackChunkaudio_visualiser"]=self["webpackChunkaudio_visualiser"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=i.O(void 0,[504],(function(){return i(5541)}));n=i.O(n)})();
//# sourceMappingURL=app.fa4ce7ff.js.map